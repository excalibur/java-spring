apply plugin: 'java'

sourceCompatibility = 1.8
version = '1.0'

repositories {
//    mavenLocal()
    mavenCentral()
}


dependencies {
//    compile 'org.springframework:spring-context:4.1.0.BUILD-SNAPSHOT'
    compile 'org.springframework:spring-context:4.0.6.RELEASE'
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

file("$rootDir/config").listFiles().each { File f ->

    task ("${f.name}", dependsOn:["compileJava", "processResources"]){
        description = "package war in ${f.name} environment"
        doLast {
            println "MYDIST-" + f.name
            copy {
                from "${f}"
                into "$buildDir/resources/main/"
                include "**/*"
            }

            doLast(classes, war){

            }
            a
            println ':classes'
            if (project.tasks.getByName("classes").getState().skipped)
            tasks.classes.execute();
            project.tasks.getByName("classes");
            classes.execute();
            println ':war'
            war.execute();
        }
    }

}
